{
  "id": "TEST-IDS-001",
  "key": "AOD-5123",
  "fields": {
    "summary": "Snort IDS Alert - ET EXPLOIT Apache Struts OGNL Injection Attempt",
    "issuetype": {
      "name": "Event Alert",
      "id": "10100"
    },
    "project": {
      "key": "AOD",
      "name": "Security Operations"
    },
    "priority": {
      "name": "Critical",
      "id": "1"
    },
    "status": {
      "name": "Open",
      "id": "1"
    },
    "created": "2025-11-09T09:47:22.000-0500",
    "updated": "2025-11-09T09:47:22.000-0500",
    "description": "# Alert Overview\n\n**Alert Source**: Snort IDS (Network Security Monitoring)\n**Alert Type**: Signature-Based Detection\n**Severity**: Critical\n**Detection Time**: 2025-11-09 09:45:18 EST\n**Alert ID**: SNORT-2025-110909-EXP-042\n**Signature ID**: ET EXPLOIT Apache Struts OGNL Injection Attempt (SID: 2024897)\n\n## Alert Description\n\nSnort detected a network packet matching a known exploit signature for Apache Struts Object-Graph Navigation Language (OGNL) injection. This attack pattern is associated with CVE-2017-5638, a critical remote code execution vulnerability in Apache Struts 2.\n\n**Attack Pattern**: HTTP POST request with malicious OGNL expression in Content-Type header\n\n**Signature Details**:\n- Rule: `ET EXPLOIT Apache Struts OGNL Injection Attempt`\n- Classification: Attempted Administrator Privilege Gain\n- CVSS Score: 10.0 (Critical)\n- Known Exploit: Yes (publicly available exploit code)\n- Associated CVE: CVE-2017-5638\n\n## Network Identifiers\n\n**Source Information:**\n- IP Address: 185.220.101.47\n- Geolocation: Netherlands (Amsterdam)\n- ASN: AS209588 (Privacy VPN Provider)\n- Reverse DNS: exit-node-47.tor-network.org\n- Reputation: Known malicious (blocklisted on 12+ threat feeds)\n- First Seen: 2025-11-09 09:45:18 (new attacker)\n\n**Destination Information:**\n- IP Address: 203.45.67.89 (External IP - NAT)\n- Internal IP: 10.100.25.10\n- Hostname: webserver-prod-03.company.local\n- Server Type: Apache Tomcat 8.5.23 running Apache Struts 2.3.32\n- Application: Customer Portal (external-facing web application)\n- Asset Owner: Application Development Team\n- Criticality: HIGH (contains customer PII and payment data)\n\n**Connection Details:**\n- Protocol: HTTP (TCP)\n- Source Port: 42891 (ephemeral)\n- Destination Port: 8080 (HTTP)\n- Request Method: POST\n- Request URI: /customer-portal/login.action\n- User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36\n- Content-Type: %{(#_='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)...}\n\n## Timeline\n\n- **2025-11-09 09:45:18** - Initial HTTP POST request received from 185.220.101.47\n- **2025-11-09 09:45:18** - Snort signature match triggered (SID: 2024897)\n- **2025-11-09 09:45:19** - Web server returned HTTP 500 Internal Server Error\n- **2025-11-09 09:45:22** - Second identical exploit attempt from same source IP\n- **2025-11-09 09:45:23** - Web server returned HTTP 500 Internal Server Error\n- **2025-11-09 09:45:30** - Third exploit attempt from same source IP\n- **2025-11-09 09:45:31** - Firewall automatically blocked source IP (IPS mode)\n- **2025-11-09 09:47:22** - JIRA ticket created automatically\n\n## Packet Capture\n\n**Malicious Request Excerpt**:\n```http\nPOST /customer-portal/login.action HTTP/1.1\nHost: 203.45.67.89:8080\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36\nContent-Type: %{(#_='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='whoami').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start())}\nContent-Length: 0\n```\n\n## Additional Context\n\n**Vulnerability Status:**\n- Application: Apache Struts 2.3.32 (VULNERABLE to CVE-2017-5638)\n- Patch Available: Yes (Struts 2.5.10 and later)\n- Last Patching Cycle: 2025-08-15 (application not patched)\n- Known Exploits: Yes (Metasploit module available, active exploitation in the wild)\n\n**Threat Intelligence:**\n- Source IP reputation: Malicious (blocklisted on AlienVault, AbuseIPDB, ThreatFox)\n- Attack campaigns: Part of automated exploit scanning (targeting known vulnerable endpoints)\n- TTPs: Initial Access > Exploit Public-Facing Application (MITRE ATT&CK T1190)\n\n**Server Response Analysis:**\n- HTTP 500 errors indicate the application attempted to process the malicious OGNL expression\n- No evidence of HTTP 200 response (successful exploitation)\n- No outbound connections initiated from webserver-prod-03 after the attack\n- No suspicious process creation logs on the server (preliminary check)\n\n**Impact Assessment:**\n- If successfully exploited: Remote Code Execution with application server privileges\n- Potential data exposure: Customer PII, payment data, session tokens\n- Lateral movement risk: Server has access to internal database servers\n\n## Disposition Options\n\n1. **True Positive**: Confirmed exploit attempt against known vulnerability (CVE-2017-5638)\n2. **False Positive**: Benign traffic incorrectly matched signature (unlikely given OGNL payload)\n3. **Benign True Positive**: Security testing or authorized penetration testing\n\n## Investigation Requirements\n\n- Confirm no authorized penetration testing was scheduled\n- Analyze web server logs for successful exploitation indicators\n- Check for outbound connections from webserver-prod-03 after the attack\n- Review process creation logs for suspicious commands (whoami, privilege escalation)\n- Validate firewall blocking effectiveness\n- Assess if vulnerability patch deployment is urgent (emergency change request)\n- Determine if customer data was accessed or exfiltrated\n- Consider isolating webserver-prod-03 for forensic analysis\n",
    "reporter": {
      "name": "snort-integration",
      "displayName": "Snort IDS Integration Bot",
      "emailAddress": "noreply@snort.local"
    },
    "assignee": null,
    "labels": [
      "ids-alert",
      "snort",
      "exploit-attempt",
      "apache-struts",
      "cve-2017-5638",
      "critical-priority",
      "ognl-injection"
    ],
    "customfield_10050": "Event Alert",
    "customfield_10051": "Exploit Attempt",
    "customfield_10052": "Critical",
    "customfield_10053": null,
    "customfield_10054": null
  },
  "metadata": {
    "testPurpose": "Test IDS alert investigation with True Positive disposition",
    "expectedDisposition": "True Positive (TP) - Confirmed exploit attempt, escalation recommended",
    "expectedInvestigationTime": "10-15 minutes",
    "keyTestingPoints": [
      "IDS signature-based detection analysis",
      "CVE association and vulnerability context",
      "Threat intelligence integration (IP reputation)",
      "Server response analysis (exploitation success determination)",
      "Escalation recommendation for unpatched critical vulnerability",
      "Evidence collection from packet captures and logs"
    ],
    "notes": "This scenario tests detection of a real-world critical exploit (CVE-2017-5638). Investigation should recommend immediate patching and potential isolation."
  }
}
