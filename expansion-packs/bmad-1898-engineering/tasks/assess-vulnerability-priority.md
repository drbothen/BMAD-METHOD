# Assess Vulnerability Priority Task

## Purpose

Calculate vulnerability remediation priority using multi-factor risk assessment combining CVSS severity, EPSS exploitation probability, CISA KEV status, asset criticality, system exposure, and exploit availability. Returns priority level (P1-P5), risk score, rationale, and SLA remediation deadline.

## Prerequisites

- Vulnerability data with CVSS score, EPSS score, KEV status, exploit status
- System context with Asset Criticality Rating (ACR) and exposure level
- CVE research completed (via `research-cve.md` task)

## Configuration Requirements

No configuration required - uses BMAD-1898 default priority framework based on CISA BOD 22-01 and NIST risk assessment principles.

**Customization:** Organizations can override priority thresholds and SLA timelines in `.bmad-core/core-config.yaml` (optional).

## Task Steps

### Step 1: Validate Input Data

**Required vulnerability data:**

- `cvss_score` (float): CVSS base score 0.0-10.0
- `epss_score` (float): EPSS probability 0.0-1.0
- `kev_status` (string): "Listed" or "Not Listed"
- `exploit_status` (string): "Active Exploitation", "Public Exploit", "PoC", or "Theoretical"

**Required system data:**

- `acr_rating` (string): "Critical", "High", "Medium", or "Low"
- `exposure` (string): "Internet", "Internal", or "Isolated"

**Validation rules:**

- CVSS score must be 0.0-10.0 (default to 0.0 if missing)
- EPSS score must be 0.0-1.0 (default to 0.0 if missing)
- KEV status must be "Listed" or "Not Listed" (default to "Not Listed" if missing)
- ACR rating must be valid enum value (default to "Medium" if missing)
- Exposure must be valid enum value (default to "Internal" if missing)
- Exploit status must be valid enum value (default to "Theoretical" if missing)

**If critical data missing:**

- Display: "‚ö†Ô∏è Missing vulnerability data: {missing_fields}"
- Continue with default values
- Flag assessment as "INCOMPLETE DATA" in rationale

### Step 2: Calculate Factor Scores

Calculate score (0-5 points) for each of 6 risk factors:

#### Factor 1: CVSS Severity (0-4 points)

**Scoring algorithm:**

```
if cvss_score >= 9.0:
    cvss_points = 4  # Critical severity
elif cvss_score >= 7.0:
    cvss_points = 3  # High severity
elif cvss_score >= 4.0:
    cvss_points = 2  # Medium severity
else:
    cvss_points = 1  # Low severity
```

**Interpretation:**

- 9.0-10.0 (Critical): Severe impact, complete system compromise possible
- 7.0-8.9 (High): Significant impact, partial system compromise possible
- 4.0-6.9 (Medium): Moderate impact, limited scope
- 0.1-3.9 (Low): Minimal impact, difficult to exploit

#### Factor 2: EPSS Exploitation Probability (0-4 points)

**Scoring algorithm:**

```
if epss_score >= 0.75:
    epss_points = 4  # Very high probability
elif epss_score >= 0.50:
    epss_points = 3  # High probability
elif epss_score >= 0.25:
    epss_points = 2  # Moderate probability
else:
    epss_points = 1  # Low probability
```

**Interpretation:**

- 0.75-1.00 (Very High): ‚â•75% likelihood of exploitation within 30 days
- 0.50-0.74 (High): 50-74% likelihood of exploitation
- 0.25-0.49 (Moderate): 25-49% likelihood of exploitation
- 0.00-0.24 (Low): <25% likelihood of exploitation

#### Factor 3: CISA KEV Status (0-5 points, OVERRIDE)

**Scoring algorithm:**

```
if kev_status == "Listed":
    kev_points = 5  # Automatic high priority (override)
else:
    kev_points = 0  # No bonus
```

**Interpretation:**

- **Listed:** CISA has confirmed active exploitation in the wild
  - **CRITICAL:** KEV listing is an override factor - automatically elevates priority
  - Per CISA BOD 22-01: Federal agencies must remediate KEV vulnerabilities within mandated timelines
- **Not Listed:** No confirmed widespread exploitation (proceed with normal scoring)

**KEV Override Rule:**
If `kev_points == 5`, vulnerability receives minimum P1 or P2 priority regardless of other factors.

#### Factor 4: Asset Criticality Rating - ACR (0-4 points)

**Scoring algorithm:**

```
acr_map = {
    "Critical": 4,  # Mission-critical systems
    "High": 3,      # Important business systems
    "Medium": 2,    # Standard systems
    "Low": 1        # Dev/test systems
}
acr_points = acr_map.get(acr_rating, 2)  # Default to Medium
```

**Interpretation:**

- **Critical (4 pts):** Mission-critical production systems
  - Examples: Payment processing, authentication servers, production databases
  - Impact: Business-critical outage, data breach, compliance violation
- **High (3 pts):** Important business systems
  - Examples: CRM, ERP, customer portals, internal apps
  - Impact: Significant business disruption
- **Medium (2 pts):** Standard business systems
  - Examples: Internal tools, reporting systems, wikis
  - Impact: Operational inconvenience
- **Low (1 pt):** Non-production systems
  - Examples: Development, test, sandbox environments
  - Impact: Minimal business impact

#### Factor 5: System Exposure (0-3 points)

**Scoring algorithm:**

```
exposure_map = {
    "Internet": 3,   # Public-facing
    "Internal": 2,   # Internal network only
    "Isolated": 1    # Air-gapped/DMZ
}
exposure_points = exposure_map.get(exposure, 2)  # Default to Internal
```

**Interpretation:**

- **Internet-Facing (3 pts):** Directly accessible from public internet
  - Attack surface: Maximum (anyone can attempt exploitation)
  - Examples: Web servers, APIs, VPNs, public cloud services
- **Internal Network (2 pts):** Accessible only from corporate network
  - Attack surface: Limited to internal users or compromised systems
  - Examples: Internal apps, file servers, databases on private network
- **Isolated (1 pt):** Air-gapped, DMZ, or highly restricted access
  - Attack surface: Minimal (requires physical access or multi-step compromise)
  - Examples: OT/ICS systems, air-gapped networks, bastion hosts

#### Factor 6: Exploit Availability (0-4 points)

**Scoring algorithm:**

```
exploit_map = {
    "Active Exploitation": 4,  # In-the-wild exploitation confirmed
    "Public Exploit": 3,       # Exploit code publicly available
    "PoC": 2,                  # Proof-of-concept exists
    "Theoretical": 1           # No known exploit
}
exploit_points = exploit_map.get(exploit_status, 1)  # Default to Theoretical
```

**Interpretation:**

- **Active Exploitation (4 pts):** Confirmed in-the-wild exploitation
  - Evidence: Threat intel reports, IDS alerts, honeypot observations
  - Risk: Imminent threat, attackers actively targeting this vulnerability
- **Public Exploit (3 pts):** Weaponized exploit code publicly available
  - Sources: ExploitDB, Metasploit, GitHub, security researcher disclosures
  - Risk: Low skill barrier, any attacker can exploit
- **PoC (2 pts):** Proof-of-concept demonstration exists
  - Sources: Research papers, vendor advisories, conference talks
  - Risk: Requires modification to weaponize, moderate skill barrier
- **Theoretical (1 pt):** No known exploit code or demonstration
  - Risk: Requires expert-level skill to develop exploit

### Step 3: Calculate Total Risk Score

**Sum all factor scores:**

```
total_score = cvss_points + epss_points + kev_points + acr_points + exposure_points + exploit_points
```

**Score range:** 0-24 points maximum

- CVSS: 0-4 points
- EPSS: 0-4 points
- KEV: 0-5 points (override factor)
- ACR: 0-4 points
- Exposure: 0-3 points
- Exploit: 0-4 points

**Score distribution examples:**

- **Maximum (24 pts):** CVSS 10.0 + EPSS 1.0 + KEV Listed + Critical ACR + Internet + Active Exploitation
- **Minimum (6 pts):** CVSS 0.0 + EPSS 0.0 + No KEV + Low ACR + Isolated + Theoretical

### Step 4: Map Score to Priority Level

**Priority mapping algorithm:**

```
if total_score >= 20 or kev_points == 5:
    priority = "P1"         # Critical
    sla_hours = 24
elif total_score >= 15:
    priority = "P2"         # High
    sla_hours = 168         # 7 days
elif total_score >= 10:
    priority = "P3"         # Medium
    sla_hours = 720         # 30 days
elif total_score >= 6:
    priority = "P4"         # Low
    sla_hours = 2160        # 90 days
else:
    priority = "P5"         # Informational
    sla_hours = None        # No SLA
```

**Priority definitions:**

**P1 - Critical (24 hour SLA):**

- **Score threshold:** ‚â•20 points OR KEV Listed
- **Criteria:** Severe vulnerabilities with imminent exploitation risk
- **Examples:**
  - CVSS 9.8 + EPSS 0.85 + KEV Listed + Critical ACR + Internet-Facing
  - Active exploitation of internet-facing production system
- **Action:** Emergency patching, war room, executive notification

**P2 - High (7 day SLA):**

- **Score threshold:** 15-19 points
- **Criteria:** High severity with significant exploitation risk
- **Examples:**
  - CVSS 8.0 + EPSS 0.60 + Public Exploit + High ACR + Internal
  - High severity with public PoC affecting important systems
- **Action:** Urgent patching within next sprint, escalate to security team

**P3 - Medium (30 day SLA):**

- **Score threshold:** 10-14 points
- **Criteria:** Moderate severity with limited exploitation risk
- **Examples:**
  - CVSS 6.5 + EPSS 0.30 + No Exploit + Medium ACR + Internal
  - Moderate severity affecting internal systems with no known exploits
- **Action:** Planned patching in regular maintenance window

**P4 - Low (90 day SLA):**

- **Score threshold:** 6-9 points
- **Criteria:** Low severity or low-criticality systems
- **Examples:**
  - CVSS 3.5 + EPSS 0.10 + Theoretical + Low ACR + Isolated
  - Low severity on development systems with theoretical risk
- **Action:** Routine patching during scheduled maintenance

**P5 - Informational (No SLA):**

- **Score threshold:** 0-5 points
- **Criteria:** Minimal risk, awareness only
- **Examples:**
  - CVSS 0.0 + EPSS 0.05 + No Exploit + Test Environment
  - Theoretical vulnerabilities with minimal business impact
- **Action:** Awareness only, optional patching, document as accepted risk

### Step 5: Apply Priority Modifiers (Override Rules)

**Automatic P1 override (regardless of calculated score):**

- KEV Listed + Internet-Facing + Critical ACR
- Active Exploitation + CVSS ‚â•9.0 + High ACR

**Priority elevation (+1 level):**

- Compliance requirement (PCI-DSS, HIPAA, SOX, etc.)
- Previous security incident involving similar vulnerability
- Executive risk acceptance required but not granted
- Customer-facing system with data breach potential

**Priority reduction (-1 level):**

- Effective compensating controls validated by security team
  - Examples: WAF rules blocking exploit, network segmentation preventing access
  - **Requirement:** Documented and tested compensating control
- System scheduled for decommission within 30 days
  - **Requirement:** Confirmed decommission date and migration plan
- Vendor end-of-life with no patch available
  - **Requirement:** Documented mitigation or replacement plan

**Modifier application logic:**

```
# Apply overrides first
if (kev_status == "Listed" and exposure == "Internet" and acr_rating == "Critical"):
    priority = "P1"
elif (exploit_status == "Active Exploitation" and cvss_score >= 9.0 and acr_rating in ["Critical", "High"]):
    priority = "P1"

# Apply elevations
if has_compliance_requirement and priority != "P1":
    priority = elevate_priority(priority)  # P2‚ÜíP1, P3‚ÜíP2, etc.

# Apply reductions
if has_compensating_controls and priority != "P5":
    priority = reduce_priority(priority)  # P2‚ÜíP3, P3‚ÜíP4, etc.
```

**Document all modifiers applied in rationale.**

### Step 6: Calculate SLA Deadline

**SLA calculation algorithm:**

```python
from datetime import datetime, timedelta

def calculate_sla_deadline(enrichment_timestamp, sla_hours):
    """Calculate exact SLA remediation deadline"""

    if sla_hours is None:
        return "No SLA (Informational)"

    # Calculate deadline
    deadline = enrichment_timestamp + timedelta(hours=sla_hours)

    # Format: "2025-11-08 14:30:00 UTC (24 hours from enrichment)"
    hours_label = f"{sla_hours} hours" if sla_hours < 48 else f"{sla_hours // 24} days"
    return f"{deadline.strftime('%Y-%m-%d %H:%M:%S UTC')} ({hours_label} from enrichment)"
```

**SLA timeline mapping:**

- **P1:** 24 hours from enrichment timestamp
- **P2:** 168 hours (7 days) from enrichment timestamp
- **P3:** 720 hours (30 days) from enrichment timestamp
- **P4:** 2160 hours (90 days) from enrichment timestamp
- **P5:** No SLA (informational only)

**SLA warnings:**

- Display breach warning if current time > 80% of SLA window
- Escalate if SLA already breached

### Step 7: Generate Priority Rationale

**Rationale template:**

```markdown
## Priority Assessment

**Priority Level:** {priority} - {priority_label}
**Overall Risk Score:** {total_score}/24 points
**SLA Remediation Deadline:** {sla_deadline}

### Factor Analysis

**1. CVSS Severity:** {cvss_score} ({cvss_severity}) ‚Üí {cvss_points}/4 points

- Vulnerability has {cvss_interpretation}

**2. EPSS Exploitation Probability:** {epss_score} ({epss_percentile}th percentile) ‚Üí {epss_points}/4 points

- {epss_interpretation}

**3. CISA KEV Status:** {kev_status} ‚Üí {kev_points}/5 points

- {kev_interpretation}

**4. Asset Criticality Rating:** {acr_rating} ‚Üí {acr_points}/4 points

- System is {acr_interpretation}

**5. System Exposure:** {exposure} ‚Üí {exposure_points}/3 points

- System is {exposure_interpretation}

**6. Exploit Availability:** {exploit_status} ‚Üí {exploit_points}/4 points

- {exploit_interpretation}

### Priority Rationale

{rationale_explanation}

{modifiers_applied}

### Recommended Actions

**Immediate Actions:**
{priority_specific_actions}

**Remediation Guidance:**
{remediation_guidance}
```

**Rationale explanation logic:**

```
if priority == "P1":
    explanation = "This vulnerability represents a CRITICAL risk requiring immediate emergency response. "
    if kev_points == 5:
        explanation += "CISA has confirmed active exploitation in the wild (KEV Listed). "
    explanation += f"The combination of {highlight_top_factors} creates an imminent threat to {acr_rating.lower()} systems."

elif priority == "P2":
    explanation = "This vulnerability represents a HIGH risk requiring urgent remediation. "
    explanation += f"The {cvss_severity} severity combined with {highlight_exploitation_factors} poses significant risk to {acr_rating.lower()} systems."

elif priority == "P3":
    explanation = "This vulnerability represents a MEDIUM risk requiring planned remediation. "
    explanation += f"While the severity is {cvss_severity}, the {highlight_mitigating_factors} reduce immediate urgency."

elif priority == "P4":
    explanation = "This vulnerability represents a LOW risk for routine patching. "
    explanation += f"The {cvss_severity} severity and {highlight_low_risk_factors} indicate limited business impact."

else:  # P5
    explanation = "This vulnerability is INFORMATIONAL only with minimal risk. "
    explanation += f"The {cvss_severity} severity and {highlight_minimal_factors} result in negligible business impact."
```

**Priority-specific actions:**

**P1 Actions:**

- Initiate emergency change process
- Notify security team and management
- Convene war room if patch requires coordination
- Prepare rollback plan
- Monitor for active exploitation attempts
- Document exception if patching delayed

**P2 Actions:**

- Schedule urgent patching in next sprint
- Notify security team
- Test patch in staging environment
- Plan production deployment
- Validate compensating controls if patch delayed

**P3 Actions:**

- Add to next maintenance window
- Test patch in non-production environment
- Schedule change request
- Monitor threat intelligence for status changes

**P4 Actions:**

- Add to routine patching schedule
- Batch with other low-priority patches
- Document in vulnerability tracking system

**P5 Actions:**

- Document for awareness
- Optional patching during opportunistic maintenance
- Consider risk acceptance

### Step 8: Return Structured Assessment Data

**Output format (YAML):**

```yaml
priority_assessment:
  priority_level: '{P1|P2|P3|P4|P5}'
  priority_label: '{Critical|High|Medium|Low|Informational}'
  total_score: { 0-24 }
  sla_hours: { 24|168|720|2160|null }
  sla_deadline: "{ISO-8601 timestamp or 'No SLA'}"
  sla_breach_warning: { true|false }

factor_scores:
  cvss:
    value: { cvss_score }
    severity: '{Critical|High|Medium|Low}'
    points: { 0-4 }
    interpretation: '{explanation}'
  epss:
    value: { epss_score }
    percentile: { epss_percentile }
    points: { 0-4 }
    interpretation: '{explanation}'
  kev:
    status: '{Listed|Not Listed}'
    points: { 0-5 }
    interpretation: '{explanation}'
  acr:
    rating: '{Critical|High|Medium|Low}'
    points: { 0-4 }
    interpretation: '{explanation}'
  exposure:
    level: '{Internet|Internal|Isolated}'
    points: { 0-3 }
    interpretation: '{explanation}'
  exploit:
    status: '{Active Exploitation|Public Exploit|PoC|Theoretical}'
    points: { 0-4 }
    interpretation: '{explanation}'

modifiers:
  overrides_applied: ['{list of override rules applied}']
  elevations_applied: ['{list of elevation reasons}']
  reductions_applied: ['{list of reduction reasons}']

rationale:
  summary: '{brief explanation of priority decision}'
  key_factors: ['{list of most influential factors}']
  recommended_actions: ['{list of immediate actions}']
  remediation_guidance: '{patching guidance}'

metadata:
  assessment_timestamp: '{ISO-8601 timestamp}'
  framework_version: 'BMAD-1898 v1.0'
  data_completeness: '{COMPLETE|INCOMPLETE - missing {fields}}'
```

### Step 9: Display Priority Assessment Summary

**Present assessment to user:**

```
‚úÖ Priority Assessment Complete

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
PRIORITY: {priority} - {priority_label}
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

Risk Score: {total_score}/24 points
SLA Deadline: {sla_deadline}
{sla_breach_warning}

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
FACTOR BREAKDOWN
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚úì CVSS Severity: {cvss_score} ({cvss_severity}) ‚Üí {cvss_points}/4 pts
‚úì EPSS Probability: {epss_score} ({epss_percentile}th %ile) ‚Üí {epss_points}/4 pts
‚úì CISA KEV: {kev_status} ‚Üí {kev_points}/5 pts
‚úì Asset Criticality: {acr_rating} ‚Üí {acr_points}/4 pts
‚úì System Exposure: {exposure} ‚Üí {exposure_points}/3 pts
‚úì Exploit Status: {exploit_status} ‚Üí {exploit_points}/4 pts

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
RATIONALE
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
{rationale_summary}

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
RECOMMENDED ACTIONS
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
{recommended_actions_list}

{modifiers_note}
```

## Error Handling

### Missing Vulnerability Data

**Symptoms:**

- CVSS score not available
- EPSS score not calculated
- KEV status unknown
- Exploit status unclear

**Recovery Strategy:**

1. Apply default values for missing fields:
   - CVSS: 0.0 (minimal severity)
   - EPSS: 0.0 (minimal probability)
   - KEV: "Not Listed"
   - Exploit: "Theoretical"
2. Flag assessment as incomplete:

   ```
   ‚ö†Ô∏è INCOMPLETE ASSESSMENT DATA

   Missing Fields:
   - CVSS score not available (defaulted to 0.0)
   - EPSS probability not calculated (defaulted to 0.0)

   Recommendation: Complete CVE research before relying on priority assessment
   ```

3. Continue with assessment using available data
4. Document data gaps in metadata: `data_completeness: "INCOMPLETE - missing CVSS, EPSS"`
5. Recommend re-assessment once missing data obtained

### Missing System Context

**Symptoms:**

- ACR rating not defined
- System exposure level unknown
- System criticality unclear

**Recovery Strategy:**

1. Prompt user for missing system context:

   ```
   ‚ö†Ô∏è System context required for accurate priority assessment

   Please provide:
   1. Asset Criticality Rating (Critical/High/Medium/Low): _______
   2. System Exposure (Internet/Internal/Isolated): _______

   Or type 'default' to use conservative estimates (Medium ACR, Internal exposure)
   ```

2. If user selects 'default', apply conservative defaults:
   - ACR: "Medium" (standard system)
   - Exposure: "Internal" (not internet-facing)
3. Document assumptions in rationale
4. Flag for manual review: "Assessment based on assumed system context"

### Invalid Input Values

**Symptoms:**

- CVSS score >10.0 or <0.0
- EPSS score outside 0.0-1.0 range
- Unrecognized enum values

**Recovery Strategy:**

1. Validate all inputs before processing
2. For invalid numerical values:

   ```
   ‚ùå Invalid CVSS score: {value}

   CVSS score must be between 0.0 and 10.0
   Please verify CVE research data and retry
   ```

3. For invalid enum values:

   ```
   ‚ùå Invalid ACR rating: "{value}"

   Valid options: Critical, High, Medium, Low
   Please provide valid rating or type 'help' for definitions
   ```

4. Max 3 retry attempts before offering default values
5. Do not proceed with assessment if critical validation fails

### SLA Already Breached

**Symptoms:**

- Current timestamp > SLA deadline
- Vulnerability past remediation timeline

**Recovery Strategy:**

1. Calculate breach duration:
   ```python
   breach_hours = (current_time - sla_deadline).total_seconds() / 3600
   ```
2. Display prominent breach warning:

   ```
   üö® SLA BREACH WARNING üö®

   This {priority} vulnerability is OVERDUE for remediation!

   Original SLA: {sla_hours} hours
   Breach Duration: {breach_hours} hours PAST deadline
   Original Deadline: {sla_deadline}

   IMMEDIATE ACTION REQUIRED:
   - Escalate to security management
   - Document delay reason
   - Expedite remediation or request risk acceptance
   ```

3. Flag in output: `sla_breach_warning: true`
4. Recommend immediate escalation to security leadership

### Conflicting Priority Factors

**Symptoms:**

- High CVSS but low EPSS
- KEV Listed but isolated system
- Critical ACR but low CVSS

**Recovery Strategy:**

1. Document conflict in rationale:

   ```
   ‚ö†Ô∏è CONFLICTING RISK FACTORS DETECTED

   High Severity Factors:
   - CVSS: 9.8 (Critical severity)
   - System: Critical ACR

   Low Urgency Factors:
   - EPSS: 0.05 (Low exploitation probability)
   - Exposure: Isolated (not internet-facing)

   Resolution: Priority calculated using multi-factor scoring algorithm
   Result: P2 (High) - Critical severity offset by low exploitation risk

   Recommendation: Monitor threat intelligence for EPSS changes
   ```

2. Highlight conflicting factors in factor breakdown
3. Explain priority decision logic clearly
4. Recommend periodic re-assessment if threat landscape changes

## Security Considerations

**DO NOT:**

- Store priority assessments with hardcoded credentials or sensitive system details
- Expose internal system architecture in priority rationale
- Auto-apply patches without authorization
- Share priority assessments outside authorized security team

**DO:**

- Document all priority modifiers and override decisions
- Maintain audit trail of priority assessments with timestamps
- Flag SLA breaches for escalation
- Re-assess priorities when new threat intelligence available
- Use priority assessments to inform risk-based patching strategies

**Audit Trail Requirements:**

- Log all priority assessments with timestamp, user, and input data
- Track priority changes over time (vulnerability aging)
- Document all manual overrides and business justifications
- Retain assessment history for compliance reporting

## Success Criteria

Task completes successfully when:

1. ‚úÖ Input data validated (or defaults applied with warnings)
2. ‚úÖ All 6 factor scores calculated
3. ‚úÖ Total risk score computed (0-24 points)
4. ‚úÖ Priority level assigned (P1-P5)
5. ‚úÖ Priority modifiers evaluated and applied
6. ‚úÖ SLA deadline calculated
7. ‚úÖ Comprehensive rationale generated
8. ‚úÖ Structured assessment data returned (YAML)
9. ‚úÖ Summary displayed to user

**Task may complete with warnings** - incomplete data or missing context does not constitute failure if documented appropriately.

## Next Steps

After priority assessment, structured data will be used by:

- **JIRA Update Tasks:** Populate custom fields (Priority, Risk Score, SLA Deadline)
- **Enrichment Documentation:** Include priority rationale in security analysis comments
- **Remediation Planning:** Schedule patching based on priority level and SLA
- **Metrics & Reporting:** Track vulnerability aging, SLA compliance, remediation velocity
- **Risk Dashboards:** Visualize vulnerability portfolio by priority distribution
- **Compliance Reporting:** Demonstrate risk-based vulnerability management for audits

**Integration with Security Analyst Agent:**
The Security Analyst agent invokes this task via the `*assess-priority {ticket-id}` command, passing vulnerability and system context data from prior CVE research and JIRA ticket analysis.
