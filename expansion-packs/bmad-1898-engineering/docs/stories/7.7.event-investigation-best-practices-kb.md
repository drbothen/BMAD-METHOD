# Story 7.7: Event Investigation Best Practices Knowledge Base

## Status

Pending

## Story

**As a** Security Analyst and Reviewer,
**I want** comprehensive knowledge base content on event investigation best practices,
**so that** I have reference guidance on investigation methodologies, disposition determination, and common false positive patterns.

## Acceptance Criteria

1. event-investigation-best-practices.md knowledge base created
2. Document covers NIST SP 800-61 incident handling framework integration
3. Document provides investigation methodology guidance (hypothesis-driven, evidence collection, correlation)
4. Document defines disposition framework (TP, FP, BTP) with clear criteria and examples
5. Document includes common false positive patterns for ICS/IDS/SIEM alerts
6. Document addresses cognitive biases in event investigation (especially automation bias)
7. Document includes ICS/SCADA-specific investigation considerations

## Tasks / Subtasks

- [ ] Create event-investigation-best-practices.md knowledge base (AC: 1)
  - [ ] Create `expansion-packs/bmad-1898-engineering/data/event-investigation-best-practices.md`
  - [ ] Structure document with clear sections
  - [ ] Include table of contents
  - [ ] Follow BMAD knowledge base format

- [ ] Document NIST SP 800-61 framework integration (AC: 2)
  - [ ] Overview of 4-phase lifecycle (Preparation, Detection & Analysis, Containment/Eradication/Recovery, Post-Incident)
  - [ ] Map event investigation activities to Detection & Analysis phase
  - [ ] Evidence preservation and chain of custody protocols
  - [ ] Prioritization criteria (functional impact, information impact, recoverability)

- [ ] Document investigation methodology (AC: 3)
  - [ ] Hypothesis-driven investigation approach
  - [ ] Evidence collection best practices (logs, network traffic, endpoint data)
  - [ ] Event correlation techniques (time-based, pattern-based, topological)
  - [ ] Timeline reconstruction
  - [ ] Alternative hypothesis consideration
  - [ ] Confidence level assignment (High/Medium/Low)

- [ ] Define disposition framework (AC: 4)
  - [ ] True Positive (TP): Genuine malicious activity confirmed
  - [ ] False Positive (FP): Benign activity incorrectly flagged
  - [ ] Benign True Positive (BTP): Real activity detected but authorized
  - [ ] Provide 5+ examples of each disposition type
  - [ ] Decision tree for disposition determination
  - [ ] Escalation criteria (when to escalate vs. close)

- [ ] Document common false positive patterns (AC: 5)
  - [ ] ICS false positives: Maintenance windows, firmware updates, authorized engineering access
  - [ ] IDS false positives: Port scans from vulnerability scanners, legitimate file transfers flagged as data exfiltration
  - [ ] SIEM false positives: Failed logins during password changes, batch job activities triggering anomaly detection
  - [ ] Tuning recommendations for each pattern

- [ ] Address cognitive biases (AC: 6)
  - [ ] Automation bias: Over-trusting alert systems without verification
  - [ ] Anchoring bias: Locked on initial alert severity
  - [ ] Confirmation bias: Seeking only supporting evidence
  - [ ] Availability bias: Over-weighting recent incidents
  - [ ] Debiasing strategies for each bias type
  - [ ] Practical examples of bias manifestation in investigations

- [ ] Document ICS/SCADA considerations (AC: 7)
  - [ ] Safety implications (availability prioritized over confidentiality)
  - [ ] Legacy system limitations (lack of logging, limited visibility)
  - [ ] Operational technology protocols (Modbus, DNP3, OPC)
  - [ ] Maintenance window considerations
  - [ ] Vendor coordination requirements
  - [ ] MITRE ATT&CK for ICS framework integration

## Dev Notes

### Epic Context

**Epic 7: Security Event Investigation Review Capability**

This story creates the knowledge base content that analysts and reviewers reference when investigating and reviewing event alerts. This complements the procedural tasks (Stories 7.1, 7.5) with conceptual guidance.

**Related Stories:**

- Story 7.1: Security Analyst Event Investigation Capability (references this KB)
- Story 7.2: Event Investigation Quality Checklists (based on these best practices)
- **Story 7.7: Event Investigation Best Practices Knowledge Base** (This story)

### Relevant Source Tree

```
expansion-packs/bmad-1898-engineering/
├── data/
│   ├── bmad-kb.md                           (Existing - general knowledge)
│   ├── cognitive-bias-patterns.md           (Existing - bias guidance)
│   ├── priority-framework.md                (Existing - CVE prioritization)
│   └── event-investigation-best-practices.md (TO BE CREATED - this story)
├── agents/
│   ├── security-analyst.md                  (Will reference this KB)
│   └── security-reviewer.md                 (Will reference this KB)
└── docs/
    └── stories/
        └── 7.7.event-investigation-best-practices-kb.md (This file)
```

**File to Create:**

- `expansion-packs/bmad-1898-engineering/data/event-investigation-best-practices.md`

### Knowledge Base Structure

```markdown
# Event Investigation Best Practices

## Table of Contents

1. Introduction
2. NIST SP 800-61 Framework Integration
3. Investigation Methodology
4. Disposition Framework
5. Common False Positive Patterns
6. Cognitive Biases in Event Investigation
7. ICS/SCADA-Specific Considerations
8. Investigation Workflow Checklist
9. References

## 1. Introduction

[Overview of event investigation purpose and scope]

## 2. NIST SP 800-61 Framework Integration

[4-phase lifecycle, Detection & Analysis phase details, evidence preservation]

## 3. Investigation Methodology

[Hypothesis-driven approach, evidence collection, correlation, timeline reconstruction]

## 4. Disposition Framework

[TP/FP/BTP definitions, decision criteria, examples, escalation guidance]

## 5. Common False Positive Patterns

[ICS, IDS, SIEM false positive patterns with tuning recommendations]

## 6. Cognitive Biases in Event Investigation

[Automation bias, anchoring, confirmation, availability biases with examples]

## 7. ICS/SCADA-Specific Considerations

[Safety implications, legacy systems, OT protocols, maintenance windows]

## 8. Investigation Workflow Checklist

[Step-by-step checklist for investigations]

## 9. References

[NIST, SANS, CISA, MITRE ATT&CK for ICS]
```

### Disposition Framework Examples

**True Positive Examples:**

1. External IP scanning multiple ports → Confirmed reconnaissance activity
2. Unauthorized SSH connection from unknown source → Confirmed lateral movement attempt
3. Data exfiltration to known C2 domain → Confirmed data theft
4. Malware hash detected on endpoint → Confirmed malware infection
5. Privilege escalation attempt on critical server → Confirmed unauthorized access attempt

**False Positive Examples:**

1. Vulnerability scanner triggering IDS signatures → Authorized security testing
2. Large file transfer flagged as exfiltration → Legitimate backup operation
3. Failed logins during password change → User credential update
4. Port scan from internal IP → Network discovery by IT operations
5. SSH from unexpected location → VPN endpoint change

**Benign True Positive Examples:**

1. SSH connection in control environment → Authorized maintenance by vendor
2. ICS protocol anomaly → Firmware update in progress
3. Multiple failed logins → User forgot password (not brute force)
4. Unusual network traffic → Batch job processing
5. File modification on critical system → Authorized patch application

### Common False Positive Patterns

**ICS/SCADA False Positives:**

- **Pattern:** "SSH Connection in Control Environments"
  - **Cause:** Scheduled maintenance, firmware updates, vendor support
  - **Tuning:** Whitelist authorized source IPs, exclude maintenance windows (00:00-04:00 UTC)

- **Pattern:** "Modbus Write Command to PLC"
  - **Cause:** HMI operator commands, SCADA system updates
  - **Tuning:** Whitelist HMI IP ranges, exclude expected write operations

- **Pattern:** "Unusual Protocol Traffic"
  - **Cause:** Legacy equipment using non-standard protocols
  - **Tuning:** Baseline normal protocol usage, exclude known legacy devices

**IDS/IPS False Positives:**

- **Pattern:** "Port Scan Detected"
  - **Cause:** Vulnerability scanners (Nessus, Qualys), network discovery tools
  - **Tuning:** Whitelist scanner IPs, schedule scans during maintenance windows

- **Pattern:** "SQL Injection Attempt"
  - **Cause:** Application error messages containing SQL keywords
  - **Tuning:** Refine signature to exclude benign SQL keywords in error messages

- **Pattern:** "Large Data Transfer"
  - **Cause:** Database backups, file synchronization
  - **Tuning:** Whitelist backup server IPs, exclude scheduled backup windows

**SIEM False Positives:**

- **Pattern:** "Multiple Failed Logins"
  - **Cause:** Password changes, expired credentials, VPN reconnections
  - **Tuning:** Increase threshold, exclude VPN endpoints, add time-window constraints

- **Pattern:** "Anomalous User Behavior"
  - **Cause:** Batch jobs, service accounts, new employee onboarding
  - **Tuning:** Exclude service accounts, adjust anomaly baseline

- **Pattern:** "Privilege Escalation Detected"
  - **Cause:** Authorized sudo usage by sysadmins
  - **Tuning:** Whitelist sysadmin accounts, exclude expected elevation patterns

## Change Log

| Date       | Version | Description            | Author     |
| ---------- | ------- | ---------------------- | ---------- |
| 2025-11-09 | 1.0     | Initial story creation | Sarah (PO) |

## Dev Agent Record

_To be populated during development_

## QA Results

_To be populated during QA_
