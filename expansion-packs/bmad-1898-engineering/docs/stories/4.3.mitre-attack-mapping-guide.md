# Story 4.3: MITRE ATT&CK Mapping Guide

## Status
Ready for Review

## Story
**As a** security analyst,
**I want** clear guidance on mapping vulnerabilities to ATT&CK,
**so that** I can accurately identify tactics and techniques.

## Acceptance Criteria
1. Common tactics for vulnerability types
2. Common techniques with T-numbers
3. Mapping examples
4. Detection implications per technique

## Tasks / Subtasks
- [x] Create MITRE ATT&CK mapping guide (AC: 1, 2, 3, 4)
  - [x] Create `expansion-packs/bmad-1898-engineering/data/mitre-attack-mapping-guide.md`
  - [x] Document common tactics for vulnerability types
  - [x] List common techniques with T-numbers
  - [x] Provide mapping examples
  - [x] Explain detection implications
- [x] Document common tactics (AC: 1)
  - [x] Initial Access (most vulnerabilities)
  - [x] Execution (RCE, command injection)
  - [x] Privilege Escalation (priv esc vulnerabilities)
  - [x] Defense Evasion (less common)
  - [x] Others as applicable
- [x] Document common techniques (AC: 2)
  - [x] T1190 - Exploit Public-Facing Application
  - [x] T1068 - Exploitation for Privilege Escalation
  - [x] T1059 - Command and Scripting Interpreter
  - [x] T1203 - Exploitation for Client Execution
  - [x] T1210 - Exploitation of Remote Services
  - [x] Others with descriptions
- [x] Create mapping examples (AC: 3)
  - [x] RCE vulnerability mapping
  - [x] SQL injection mapping
  - [x] Privilege escalation mapping
  - [x] DoS vulnerability mapping
  - [x] Authentication bypass mapping
- [x] Document detection implications (AC: 4)
  - [x] What to monitor for each technique
  - [x] IDS/IPS signatures
  - [x] Log analysis patterns
  - [x] Defensive recommendations

## Dev Notes

### Source Requirements

**Epic Reference:** `expansion-packs/bmad-1898-engineering/docs/prd/epic-4-knowledge-base.md` - Story 4.3

**Epic Requirements (Story 4.3 Acceptance Criteria):**
1. Common tactics for vulnerability types (Initial Access, Execution, Privilege Escalation, etc.)
2. Common techniques with T-numbers (T1190, T1068, T1059, etc.)
3. Mapping examples using realistic CVE scenarios
4. Detection implications per technique

**Technical Requirements from Epic 4:**
- Tactics/techniques must be relevant to common vulnerability types in enterprise security
- CVE examples should represent realistic scenarios (RCE, SQL injection, privilege escalation, DoS, authentication bypass)
- Detection recommendations must be actionable (specific monitoring, IDS/IPS, log analysis)
- Guide must support Security Analyst enrichment workflow (not full incident response scope)

**Scope from Epic 4:**
- **IN SCOPE:** Mapping CVEs to ATT&CK for enrichment purposes (understanding attack paths, prioritizing detection)
- **IN SCOPE:** Common techniques for vulnerability exploitation (T1190, T1068, T1059, T1203, T1210, T1133, T1498)
- **IN SCOPE:** Detection implications (what to monitor per technique)
- **OUT OF SCOPE:** Full ATT&CK framework reference (all 14 tactics, 200+ techniques) - focus on vulnerability-relevant subset
- **OUT OF SCOPE:** Advanced persistent threat (APT) campaign mapping - focus on vulnerability exploitation
- **OUT OF SCOPE:** Custom CVEs specific to organization's stack - use generic representative examples

### Source Tree Context

**File Location:** `expansion-packs/bmad-1898-engineering/data/mitre-attack-mapping-guide.md`

**Related Files (from source-tree.md):**
```
expansion-packs/bmad-1898-engineering/
├── data/                             # Knowledge bases and reference materials
│   ├── bmad-kb.md                   # Vulnerability management KB (Story 4.1)
│   ├── cognitive-bias-patterns.md   # Cognitive bias guide (Story 4.2)
│   └── mitre-attack-mapping-guide.md # THIS FILE (Story 4.3)
│
├── docs/
│   ├── prd/
│   │   └── epic-4-knowledge-base.md # Source requirements
│   ├── architecture/
│   │   └── source-tree.md           # Directory structure reference
│   └── stories/
│       └── 4.3.mitre-attack-mapping-guide.md # This story
```

**Integration Points (from Epic 4):**
- ATT&CK mapping must be referenceable from JIRA enrichment comments (Story 1.5)
- Detection implications must support remediation guidance (Story 4.1 remediation strategies)
- Referenced by Security Reviewer's fact verification checklist (Story 2.5)

### Implementation Guidance

**Structure the guide to include:**

1. **Introduction**
   - Explain MITRE ATT&CK framework (Tactics = "why", Techniques = "how")
   - Explain purpose: Understanding attack paths, prioritizing detection
   - Reference: https://attack.mitre.org

2. **Common Tactics for Vulnerability Types** (AC 1)
   - Initial Access: RCE, authentication bypass, SQL injection in public apps, file upload
   - Execution: RCE, command injection, deserialization, SSTI
   - Privilege Escalation: Local priv esc, kernel vulnerabilities, sudo/setuid misconfig
   - Impact: DoS, data destruction

3. **Common Techniques with T-Numbers** (AC 2)
   - T1190 - Exploit Public-Facing Application (web app RCE, SQL injection, file upload, auth bypass)
   - T1068 - Exploitation for Privilege Escalation (local priv esc, kernel vulns, polkit)
   - T1059 - Command and Scripting Interpreter (command injection, shell injection)
   - T1203 - Exploitation for Client Execution (browser, PDF, Office exploits)
   - T1210 - Exploitation of Remote Services (SMB, RDP, SSH vulns)
   - T1133 - External Remote Services (VPN, RDP, remote access vulns)
   - T1498 - Network Denial of Service (DoS vulnerabilities)
   - Include description, CVE types, detection, defense for each

4. **Mapping Examples** (AC 3)
   - RCE example (map to T1190 + T1059)
   - SQL injection example (map to T1190)
   - Local privilege escalation example (map to T1068)
   - DoS example (map to T1498)
   - Authentication bypass example (map to T1190 + T1078)
   - Use realistic CVE scenarios with CVSS scores, attack vectors

5. **Detection Implications per Technique** (AC 4)
   - T1190: Monitor web logs, WAF alerts, IDS/IPS, unusual HTTP patterns
   - T1068: Monitor auth logs, process creation, kernel module loading
   - T1059: Monitor shell execution, command-line logging, process relationships
   - Include specific tools: WAF, IDS/IPS, SIEM, auditd, EDR

6. **Quick Reference Table**
   - CVE Type → Primary Tactic → Primary Technique mapping

**Authoritative Sources to Reference:**
- MITRE ATT&CK: https://attack.mitre.org
- Verify all T-numbers are valid on attack.mitre.org
- Use publicly known CVE examples (EternalBlue, Shellshock, PwnKit, etc.)

**Content Validation:**
- All techniques must exist in MITRE ATT&CK framework
- Detection recommendations must be actionable
- Examples must be realistic and representative
- Align with multi-factor risk assessment from Story 4.1 (CVSS + EPSS + KEV)

### Testing

**Test Location:** `expansion-packs/bmad-1898-engineering/data/`

**Test Standards (from Epic 4):**
- Content accuracy validated against authoritative sources (MITRE ATT&CK)
- Comprehension tested with new analysts
- Examples validated for realism and correctness
- All external URLs verified as valid

**Test Cases:**
1. Analyst maps 10 CVEs: Do mappings match expert assessment? (90%+ accuracy per Epic 4 success criteria)
2. Reference check: All T-numbers valid on attack.mitre.org
3. Detection recommendations: Are they actionable and accurate?
4. Example validation: Examples correctly demonstrate mapping

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-11-06 | 1.0 | Initial story creation | Sarah (PO) |
| 2025-11-07 | 1.1 | Remediation: Added Epic 4, source traceability, source tree context, full file paths | Sarah (PO) |
| 2025-11-07 | 1.2 | Implementation: Created MITRE ATT&CK mapping guide with all ACs complete | James (Dev) |

## Dev Agent Record

### Agent Model Used
Claude Sonnet 4.5 (claude-sonnet-4-5-20250929)

### Debug Log References
No debug issues encountered during development.

### Completion Notes List
- Created comprehensive MITRE ATT&CK mapping guide covering all acceptance criteria
- Documented 4 common tactics (Initial Access, Execution, Privilege Escalation, Impact)
- Documented 7 techniques with full T-numbers (T1190, T1068, T1059, T1203, T1210, T1133, T1498)
- Provided 5 realistic mapping examples with attack flows and detection implications
- Included detailed detection implications for each technique (monitoring, IDS/IPS, log analysis, SIEM, defensive measures)
- Added quick reference table for CVE type to technique mapping
- Verified all T-numbers against MITRE ATT&CK framework
- Included integration guidance with vulnerability assessment workflow (Story 4.1)
- Added authoritative references section

### File List
- **Created:** `expansion-packs/bmad-1898-engineering/data/mitre-attack-mapping-guide.md`

## QA Results

### QA Review Date: 2025-11-08
**Reviewer:** Quinn (Test Architect)
**Review Type:** Risk Profile + T-Number Verification

### Assessment Summary
**Status:** ✅ **PASS** (after corrections applied)

**Reviews Completed:**
1. ✅ Risk Profile Assessment
2. ✅ T-Number Verification (8 T-numbers, 4 tactics verified against attack.mitre.org)
3. ✅ CVE Example Validation (7/7 accurate)
4. ✅ External URL Validation (all links valid)
5. ✅ T1210 Mapping Correction Applied

### Key Findings

**T-Number Verification Results:**
- All 8 T-numbers verified as valid MITRE ATT&CK techniques ✅
- All 4 tactic numbers verified as valid ✅
- CVE examples all accurate and appropriately mapped ✅
- Detection guidance technically sound and actionable ✅

**Issue Identified & Corrected:**
- **T1210 Tactic Mapping:** Initially mapped to "Initial Access / Lateral Movement" but MITRE officially categorizes as Lateral Movement (TA0008) only
- **Resolution:** Updated guide v1.1 with corrections:
  - T1210 description updated to focus on lateral movement
  - Quick Reference Table clarified with "(internal)" vs "(internet-facing)" distinctions
  - Added scope note explaining TA0008 coverage
  - Added new table row for internet-facing RDP/SSH/SMB → T1190

### Risk Assessment
**Overall Risk Score:** 34/100 (Moderate-High) → Reduced to Low after T1210 correction

**Critical Risk (TECH-001):** Incorrect T-numbers
- **Status:** RESOLVED ✅
- **Mitigation:** All T-numbers verified against attack.mitre.org; T1210 mapping corrected

**High Risks Identified:**
- TECH-002: Content staleness (mitigated with quarterly review schedule)
- SEC-001: Detection guidance accuracy (spot-checked and validated)
- OPS-001: No maintenance process (requires maintenance runbook creation)

### Testing Requirements

**Completed:**
✅ T-number verification test (8/8 valid)
✅ CVE example validation (7/7 accurate)
✅ External URL validation (0 broken links)
✅ Detection guidance spot-check (technically sound)

**Pending Before Deployment:**
- [ ] 10-CVE mapping accuracy test (Epic 4 success criteria: ≥90%)
- [ ] SecOps review of detection guidance
- [ ] Usability testing with 2-3 analysts
- [ ] Integration testing with Story 1.5 JIRA workflow
- [ ] Maintenance runbook creation

### Gate Recommendation
**Gate Status:** CONCERNS → PASS (after T1210 correction)

**Conditions Met:**
- ✅ All T-numbers verified correct
- ✅ T1210 tactic mapping corrected
- ✅ CVE examples validated
- ✅ Detection guidance reviewed

**Remaining Requirements:**
- Execute 10-CVE accuracy test achieving ≥90%
- SecOps review of detection implications
- Create maintenance schedule and runbook

### Reports Generated
- Risk Profile: `docs/qa/assessments/4.3-risk-20251108.md`
- T-Number Verification: `docs/qa/assessments/4.3-tnumber-verification-20251108.md`

### Next Steps
1. Execute 10-CVE mapping accuracy test
2. SecOps review of detection guidance
3. Usability testing with analysts
4. Create maintenance runbook (OPS-001 mitigation)
5. Generate gate decision file

**QA Sign-off:** Ready for final validation testing after corrections applied
