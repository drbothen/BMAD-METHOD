# Story 4.1: Vulnerability Management Knowledge Base

## Status
Draft

## Story
**As a** security analyst,
**I want** comprehensive vulnerability management best practices,
**so that** I understand frameworks like CVSS, EPSS, KEV, ACR.

## Acceptance Criteria
1. Knowledge base includes NIST NVD, CVSS, EPSS, KEV, ACR frameworks
2. Industry statistics (2025 CVE volume, alert fatigue data)
3. Remediation approaches explained
4. Multi-factor risk assessment methodology

## Tasks / Subtasks
- [ ] Create vulnerability management knowledge base (AC: 1, 2, 3, 4)
  - [ ] Create `data/bmad-kb.md` for BMAD-1898
  - [ ] Document all frameworks and methodologies
  - [ ] Include industry context and statistics
  - [ ] Add examples and use cases
  - [ ] Link to authoritative sources
- [ ] Document NIST NVD framework (AC: 1)
  - [ ] Purpose and scope
  - [ ] How to use NVD
  - [ ] CVE ID format and structure
  - [ ] NVD update frequency
  - [ ] URL: https://nvd.nist.gov
- [ ] Document CVSS framework (AC: 1)
  - [ ] CVSS v3.1 scoring system
  - [ ] Base score components (AV, AC, PR, UI, S, C, I, A)
  - [ ] Vector string format
  - [ ] Severity ratings (Critical/High/Medium/Low)
  - [ ] Example: CVE-2024-1234 → CVSS 9.8
- [ ] Document EPSS framework (AC: 1)
  - [ ] Exploitation Prediction Scoring System
  - [ ] Score range (0.0-1.0)
  - [ ] Percentile interpretation
  - [ ] Daily updates
  - [ ] URL: https://www.first.org/epss
- [ ] Document CISA KEV catalog (AC: 1)
  - [ ] Known Exploited Vulnerabilities
  - [ ] KEV listing criteria
  - [ ] Date_added and due_date
  - [ ] Required actions
  - [ ] URL: https://www.cisa.gov/known-exploited-vulnerabilities-catalog
- [ ] Document Asset Criticality Rating (ACR) (AC: 1)
  - [ ] Critical/High/Medium/Low ratings
  - [ ] How to assess system criticality
  - [ ] Business impact considerations
  - [ ] Examples: Production DB (Critical), Dev Server (Low)
- [ ] Include industry statistics (AC: 2)
  - [ ] 2025 CVE volume: 50,000+ projected
  - [ ] Alert fatigue: 78% alerts uninvestigated
  - [ ] Analyst productivity data
  - [ ] Industry benchmarks
- [ ] Document remediation approaches (AC: 3)
  - [ ] Patching (preferred)
  - [ ] Workarounds (temporary)
  - [ ] Compensating controls (mitigation)
  - [ ] System isolation (containment)
  - [ ] Risk acceptance (documented decision)
- [ ] Document multi-factor risk assessment (AC: 4)
  - [ ] CVSS + EPSS + KEV + Business Context
  - [ ] Priority calculation algorithm
  - [ ] Factor weighting
  - [ ] Priority framework (P1-P5)
  - [ ] SLA timelines

## Dev Notes

### BMAD Knowledge Base Structure

```markdown
# BMAD-1898 Engineering Expansion Pack Knowledge Base

## Table of Contents
1. Introduction
2. Vulnerability Management Landscape
3. Frameworks and Standards
4. Risk Assessment Methodology
5. Remediation Strategies
6. References

---

## 1. Introduction

BMAD-1898 is an AI-assisted security vulnerability enrichment and quality assurance expansion pack for the BMAD Method™ framework. It addresses the challenge of 50,000+ annual CVE disclosures by enabling analysts to enrich vulnerability tickets 90% faster while maintaining enterprise-grade quality through systematic peer review.

**Key Components:**
- Security Analyst Agent: AI-assisted enrichment
- Security Reviewer Agent: Systematic QA review
- 8 Quality Dimension Checklists
- Multi-Factor Risk Assessment Framework

---

## 2. Vulnerability Management Landscape

### Current Challenge (2025)

**CVE Volume:**
- 2024: 43,000+ CVE disclosures
- 2025: 50,000+ projected (18% increase)
- 2030: 75,000+ estimated

**Alert Fatigue:**
- 78% of security alerts go uninvestigated
- Average analyst processes 10-20 alerts/day manually
- With AI assistance: 50-100 alerts/day possible

**Traditional CVSS-Only Approach:**
- Problem: CVSS only measures severity, not exploitability
- Result: Patching theoretical risks while missing genuine threats
- Example: CVSS 9.8 vulnerability with EPSS 0.02 (low exploitation probability)

**BMAD-1898 Solution:**
- Multi-factor risk assessment (CVSS + EPSS + KEV + Business Context)
- AI-assisted research (10-15 min vs. hours)
- Systematic QA (60-70% more defects found)

---

## 3. Frameworks and Standards

### 3.1 NIST NVD (National Vulnerability Database)

**Purpose:** Authoritative source for CVE details, CVSS scores, affected products

**URL:** https://nvd.nist.gov

**CVE ID Format:** CVE-YYYY-NNNNN
- YYYY: Year of disclosure
- NNNNN: 4-7 digit identifier
- Example: CVE-2024-1234

**Information Provided:**
- CVE description
- CVSS v3.1 base score and vector
- Affected products and versions
- References (vendor advisories, exploits)
- CWE (Common Weakness Enumeration)

**Update Frequency:** Real-time (hours after disclosure)

---

### 3.2 CVSS (Common Vulnerability Scoring System)

**Purpose:** Standardized severity scoring (0.0-10.0)

**Version:** CVSS v3.1 (current standard)

**Base Score Metrics:**
- **AV (Attack Vector):** Network/Adjacent/Local/Physical
- **AC (Attack Complexity):** Low/High
- **PR (Privileges Required):** None/Low/High
- **UI (User Interaction):** None/Required
- **S (Scope):** Unchanged/Changed
- **C (Confidentiality Impact):** None/Low/High
- **I (Integrity Impact):** None/Low/High
- **A (Availability Impact):** None/Low/High

**Vector String Example:**
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**Severity Ratings:**
- 0.0: None
- 0.1-3.9: Low
- 4.0-6.9: Medium
- 7.0-8.9: High
- 9.0-10.0: Critical

**Limitation:** CVSS measures severity, NOT exploitability

---

### 3.3 EPSS (Exploit Prediction Scoring System)

**Purpose:** Data-driven exploitation probability prediction

**URL:** https://www.first.org/epss

**Score Range:** 0.0 - 1.0 (0% to 100% probability)

**Percentile:** Ranks vulnerability against all CVEs

**Interpretation:**
- 0.00-0.25: Low exploitation probability
- 0.26-0.49: Moderate exploitation probability
- 0.50-0.75: High exploitation probability
- 0.76-1.00: Very high exploitation probability

**Example:**
- EPSS Score: 0.85 (85th percentile)
- Meaning: 85% probability of exploitation in next 30 days
- Context: In top 15% of most exploitable vulnerabilities

**Update Frequency:** Daily

**Why EPSS Matters:**
- Many CVSS 9.0+ vulnerabilities have EPSS <0.10 (rarely exploited)
- Some CVSS 6.0 vulnerabilities have EPSS >0.80 (frequently exploited)
- EPSS + CVSS provides complete risk picture

---

### 3.4 CISA KEV (Known Exploited Vulnerabilities)

**Purpose:** Catalog of vulnerabilities actively exploited in the wild

**URL:** https://www.cisa.gov/known-exploited-vulnerabilities-catalog

**Listing Criteria:**
- Assigned CVE ID
- Reliable evidence of active exploitation
- Clear remediation action available

**KEV Fields:**
- CVE ID
- Date Added to KEV
- Due Date (Federal agencies must remediate by this date)
- Required Action
- Vendor/Project
- Known Ransomware Campaign Use

**Why KEV Matters:**
- CISA observes active exploitation
- Federal mandates require KEV vulnerabilities patched within timelines
- Strong signal for prioritization (should be P1 or P2)

**Example:**
- CVE-2024-1234 added to KEV on 2024-11-01
- Due Date: 2024-11-22 (21 days)
- Required Action: Apply updates per vendor instructions

---

### 3.5 Asset Criticality Rating (ACR)

**Purpose:** Business impact classification for systems

**Ratings:**
- **Critical:** Mission-critical systems (production databases, payment systems, authentication servers)
- **High:** Important business systems (CRM, ERP, customer portals)
- **Medium:** Standard business systems (internal tools, reporting)
- **Low:** Development, test, or non-production systems

**Assessment Factors:**
- Business process dependency
- Data sensitivity
- Downtime impact
- Regulatory requirements
- Customer impact

**Example:**
- Production payment processing server: Critical
- Internal wiki: Medium
- Dev sandbox: Low

---

## 4. Risk Assessment Methodology

### Multi-Factor Priority Framework

BMAD-1898 uses a **multi-factor risk assessment** approach combining:

1. **CVSS Score** (Severity)
2. **EPSS Score** (Exploitability)
3. **CISA KEV Status** (Active Exploitation)
4. **Asset Criticality Rating** (Business Impact)
5. **System Exposure** (Internet/Internal/Isolated)
6. **Exploit Availability** (PoC/Public/Active)

### Priority Levels (P1-P5)

**P1 - Critical (24 hour SLA):**
- Criteria: CVSS ≥9.0 + EPSS ≥0.75 + KEV Listed, OR Active Exploitation + Internet-Facing + Critical ACR
- Example: RCE in internet-facing production database with active exploitation
- Action: Emergency patching, war room if needed

**P2 - High (7 day SLA):**
- Criteria: CVSS ≥7.0 + EPSS ≥0.50 + (KEV Listed OR Public Exploit), OR High ACR + Internet-Facing
- Example: High severity with public PoC affecting important systems
- Action: Urgent patching within next sprint

**P3 - Medium (30 day SLA):**
- Criteria: CVSS 4.0-6.9 + Moderate EPSS + Internal Exposure, OR Medium ACR + No Active Exploitation
- Example: Moderate severity affecting internal systems with no known exploits
- Action: Planned patching in regular maintenance window

**P4 - Low (90 day SLA):**
- Criteria: CVSS <4.0 OR Low ACR + No Exploit + Isolated System
- Example: Low severity on development systems with theoretical risk
- Action: Routine patching during scheduled maintenance

**P5 - Informational (No SLA):**
- Criteria: CVSS <2.0 + No Exploit + Test Environment
- Example: Theoretical vulnerabilities with minimal business impact
- Action: Awareness only, optional patching

---

## 5. Remediation Strategies

### 5.1 Patching (Preferred)

**When:** Vendor patch available

**Actions:**
- Identify patched version
- Review patch release notes
- Test in non-production
- Schedule deployment
- Verify patch applied successfully

**Priority:** Always preferred over workarounds

---

### 5.2 Workarounds (Temporary)

**When:** No patch available yet, vendor provides workaround

**Actions:**
- Implement vendor-recommended workaround
- Document workaround steps
- Monitor for patch availability
- Plan to remove workaround once patched

**Example:** Disable vulnerable feature until patch available

---

### 5.3 Compensating Controls (Mitigation)

**When:** Patching delayed, need to reduce risk

**Actions:**
- WAF rules to block exploitation attempts
- Network segmentation to limit exposure
- IDS/IPS signatures to detect exploitation
- Enhanced logging and monitoring
- Access restrictions

**Note:** Controls mitigate but don't eliminate vulnerability

---

### 5.4 System Isolation (Containment)

**When:** Critical vulnerability, no patch, high exploitation risk

**Actions:**
- Remove system from network
- Restrict access to trusted users only
- Implement compensating controls
- Plan replacement or rebuild

---

### 5.5 Risk Acceptance (Documented Decision)

**When:** Remediation cost exceeds risk, or system decommissioning soon

**Actions:**
- Document risk acceptance decision
- Obtain management approval
- Implement monitoring
- Set review date
- Plan eventual remediation or decommissioning

---

## 6. References

### Authoritative Sources

**NIST NVD:**
- URL: https://nvd.nist.gov
- Purpose: CVE details, CVSS scores

**CISA KEV:**
- URL: https://www.cisa.gov/known-exploited-vulnerabilities-catalog
- Purpose: Known exploited vulnerabilities

**FIRST EPSS:**
- URL: https://www.first.org/epss
- Purpose: Exploitation probability scores

**MITRE ATT&CK:**
- URL: https://attack.mitre.org
- Purpose: Adversary tactics and techniques

### Industry Research

- SANS Institute: Security trends and statistics
- Gartner: Vulnerability management research
- Verizon DBIR: Data breach investigation reports
```

### Testing

**Test Location:** `expansion-packs/bmad-1898-engineering/data/`

**Test Standards:**
- Validate knowledge base is comprehensive
- Verify all frameworks explained clearly
- Test with new analysts (comprehension check)
- Ensure authoritative sources linked

**Test Cases:**
1. New analyst reads KB: Can they understand CVSS/EPSS/KEV?
2. Reference check: All URLs valid and accessible
3. Example validation: Examples accurate and helpful
4. Completeness: All acceptance criteria covered

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-11-06 | 1.0 | Initial story creation | Sarah (PO) |

## Dev Agent Record

### Agent Model Used
_To be populated during development_

### Debug Log References
_To be populated during development_

### Completion Notes List
_To be populated during development_

### File List
_To be populated during development_

## QA Results
_To be populated after QA review_
